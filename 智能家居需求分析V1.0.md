* [目录](#0)
   * [1 训练智能对话技能的总体流程](#1)
   * [2 需求分析](#2)
   * 　　[2.1 业务场景分析](#2.1)
   * 　　[2.2 功能定义](#2.2)
   * 　　[2.3 对话逻辑梳理](#2.3)
   * 　　[2.4 场景数据收集](#2.4)

<h1 id="1">1 训练智能对话技能的总体流程</h1>

![](https://i.imgur.com/hHVh7uJ.png)　　

　　总共分为3个阶段，需求分析并做好前期准备工作→通过UNIT创建最小可用技能模型→持续优化技能模型，具体如下：

　　第1阶段：需求分析。当前阶段需要有熟悉业务的人员参加，例如：产品经理、业务负责人等。先分析业务，明确业务中哪里需要通过和用户的对话来完成；再确认相关对话逻辑。最后基于之前的分析，从之前沉淀的数据中提取有价值信息，用于后续技能创建与训练；如果是新业务或之前没有准备，也先不用着急，我们可以先完成其他部分，但综合来看，业务中的真实数据是训练技能时最理想的“知识”。

　　第2阶段，创建&训练技能。当前阶段就是要赋予技能模型对话能力了。赋予技能模型对话能力和教小朋友说话一样，要先确认教他的知识点，而这些知识点就是技能的意图。基本定义灌输完成后，就需要通过大量的练习题来帮助技能模型理解、巩固与记忆。最后，可以通过考试，来检测技能模型的学习成果。当考试合格后，就可以用于实战了，即接入咱们的业务中（API、SDK等）。

　　第3阶段，持续优化。因着业务程度复杂、用户画像变化等因素，技能之前掌握的只是知识可能不足以应对新市场，这时我们需要通过更多的“练习”与“考试”来帮助技能提高能力。目前技能还无法完全自主学习并提高自己，还需要训练人员辅助。


<h1 id="２">2 需求分析</h1>
　　需求分析是训练智能对话技能举足轻重的一步，需要基于自身业务场景进行深入透彻的思考，从而明确整个对话技能的架构，后续的技能创建与训练工作全部在此架构的基础上展开。这一步在训练智能对话技能时很容易被忽视，但草率分析需求即着手训练的技能往往后续需要投入更多的时间和精力进行调整，甚至需要推翻重来；

<h2 id="2.1"> 2.1 业务场景分析：确定边界，明确目标</h2>  
<h3> 2.1.1 挖掘需求，确定边界</h3>
　　首先是对业务场景进行分析，在智能家居服务这一场景下存在很多智能家居助手“可以做”的业务，我们应当从用户需求和用户体验入手，思考在该场景下用户的刚需，以及如何通过引入对话交互来大幅提升用户体验，从而在大范围的“可以做”的业务中找到其中“必须做”和“应该做”的业务。

![](https://i.imgur.com/2sUYiNl.png)

　　在智能家居这一场景下，用户主要的活动空间是在房间内，因此首要目标为尽可能优化用户在家里的体验。智能家居可以分为以下五大模块：

　　1）环境监测：环境监测模块主要是对室内环境进行监测，方便用户随时随地了解住宅内的状态。包括了对房间温湿度、空气质量的监测，以及监控室内是否有漏水、煤气泄漏的情况。

　　２）智能家电：通过语音交互对房屋内各种各样的家用电器进行控制，实现家用电器的互联。例如，用户可以选择让客厅或卧室的灯光打开或关闭，也可以通过对话进行电视换台，音量增减等。

　　3）安防警报：智能家居不仅应实现对家庭各式电器的操控，还应为住户提供基础的安全保护措施。例如，针对烟雾、煤气、漏水等情况的报警，如果家里有老人或残疾人，还能设置防跌倒报警。

　　4）日程提醒：根据用户提供的行程安排适时地做提醒。

　　5）意见反馈：增强系统交互性和用户体验感。

　　像环境监测、智能家电控制、安防警报这些都是需要优先满足的需求；而设置日程提醒、门禁控制，这些功能通过语音交互来实现可以使用户进一步感受到智能家居的舒适和创新；意见反馈有助于收集用户的反馈以不断优化系统服务，通过智能家居的对话来完成可以获得比纸质调查表更高的反馈率。

　　而关于家庭常见问题的咨询，也是智能家居应当实现的功能之一：一方面这些问题对于住户而言是切实需要获得解答的，另一方面直接通过对话方式获得问题的解答比传统的从宣传单中查找或是致电询问前台都更加简单便捷。

　　对于一些基本服务以外的拓展服务，如新闻播报、城市导览等功能，可以对用户体验起到一定的提升，但并非强需求，同时需要对接大量的资源库；而我们的目标是首先搭建最小可用技能，因此这部分功能可以先不去开发或低优先级开发。

<h3>2.1.2 明确目标，确定任务类型</h3>
    在确定了业务场景的边界之后，我们就需要明确这些功能的目标，从而确定任务的类型，不同的任务类型对应着不同的配置方式。任务类型区分的关键在于任务目标的有无以及是否需要把请求参数化。对之前梳理的功能进行分类：

<br>
<table style="margin: 0 auto;width:700px">
	<tr>
		<th rowspan="16">房间内场景</th>
		<td>环境监测-空气质量</td>
		<td>任务型</td>
	</tr>
    <tr>
		<td>环境监测-燃气监测</td>
        <td>任务型</td>
	</tr>
    <tr>
        <td>环境监测-温湿度</td>
        <td>任务型</td>
    </tr>
    <tr>
        <td>环境监测-漏水检测</td>
        <td>任务型</td>
    </tr>
    <tr>
        <td>智能家电-灯光控制</td>
        <td>任务型</td>
    </tr>
    <tr>
        <td>智能家电-窗帘开关</td>
        <td>任务型</td>
    </tr>
    <tr>
        <td>智能家电-饮水机开关</td>
        <td>任务型</td>
    </tr>
    <tr>
        <td>智能家电-热水器开关</td>
        <td>任务型</td>
    </tr>
    <tr>
        <td>智能家电-加湿器开关</td>
        <td>任务型</td>
    </tr>
    <tr>
        <td>智能家电-空调控制</td>
        <td>任务型</td>
    </tr>
    <tr>
        <td>智能家电-电视机控制</td>
        <td>任务型</td>
    </tr>
    <tr>
          <td>智能家电-门禁控制</td>
          <td>任务型</td>
    </tr>
    <tr>
         <td>安全报警-紧急求助</td>
         <td>任务型</td>
    </tr>
    <tr>
        <td>安全报警-报警器控制</td>
        <td>任务型</td>
    </tr>
    <tr>
         <td>日程提醒</td>
         <td>任务型</td>
    </tr>
    <tr>
        <td>意见反馈</td>
        <td>任务型</td>
    </tr>
    <tr>
        <th rowspan="4">问题咨询</th>
        <td>地下车库位置</td>
        <td rowspan="4">问答型</td>
    </tr>
    <tr>
        <td>洗衣房位置</td>
    </tr>
    <tr>
        <td>阅览室开放时间</td>
     </tr>
    <tr>
        <td>……</td>
    </tr>
    <tr>
        <th rowspan="3">拓展服务</th> 
        <td>城市导览</td>
        <td rowspan="2">任务型</td>
     </tr>
    <tr>
        <td>新闻播报</td>
    </tr>
    <tr>
        <td>休闲聊天</td>
        <td>闲聊型</td>
    </tr>
</table>

<h2 id="2.2"> 2.2 功能定义：确定优先级及关键信息要素</h2>
    在确定边界和目标后，我们就可以动手对功能进行定义了，在这一阶段，我们需要确定各功能的优先级，并确定每个功能的实体要素。
<h3>2.2.1 优先级的确定</h3>
    首先是优先级的确定，其实在确定边界的过程中，我们已经对功能的重要程度和实现难度进行了分析，在此基础上不难确定出功能的优先级：

<table style="margin: 0 auto;width:700px">
     <tr>
          <th rowspan="16">房间内场景</th>
          <td>环境监测-空气质量</td>
          <td rowspan="15">P0</td>
     </tr>
     <tr>
          <td>环境监测-燃气监测</td>
     </tr>
     <tr>
          <td>环境监测-温湿度</td>
     </tr>
     <tr>
          <td>环境监测-漏水检测</td>
     </tr>
     <tr>
          <td>智能家电-灯光控制</td>
     </tr>
     <tr>
          <td>智能家电-窗帘开关</td>
     </tr>
     <tr>
          <td>智能家电-饮水机开关</td>
     </tr>
     <tr>
          <td>智能家电-热水器开关</td>
     </tr>
     <tr>
          <td>智能家电-加湿器开关</td>
     </tr>
     <tr>
          <td>智能家电-空调控制</td>
     </tr>
     <tr>
          <td>智能家电-电视机控制</td>
     </tr>
     <tr>
          <td>智能家电-门禁控制</td>
     </tr>
     <tr>
          <td>安全报警-紧急求助</td>
     </tr>
     <tr>
          <td>安全报警-报警器控制</td>
     </tr>
     <tr>
          <td>日程提醒</td>
     </tr>
     <tr>
          <td>意见反馈</td>
          <td>P1</td>
     </tr>
     <tr>
          <th rowspan="4">问题咨询</th>
          <td>地下车库位置</td>
          <td rowspan="4">P0</td>
     </tr>
     <tr>
          <td>洗衣房位置</td>
     </tr>
     <tr>
          <td>阅览室开放时间</td>
     </tr>
     <tr>
          <td>……</td>
     </tr>
     <tr>
          <th rowspan="3">拓展服务</th> 
          <td>城市导览</td>
          <td rowspan="2">P2</td>
     </tr>
     <tr>
          <td>新闻播报</td>
     </tr>
     <tr>
          <td>休闲聊天</td>
          <td>P3</td>
     </tr>
</table>


<h3> 2.2.2 关键信息要素的分析</h3>
　　任务型的对话需要将请求参数化，相应的我们就需要分析要完成每个对话都需要将哪些实体要素参数化，而这些实体要素所对应的正是技能的对话意图及其词槽。对智能家居系统各功能进行分析，可以梳理出如下的关键信息要素：
<br>
	<table style="margin: 0 auto;width:800px">
     <tr>
          <th rowspan="2" colspan="2">功能</th>
          <th colspan="2">关键信息要素</th>
     </tr>
     <tr>
          <th>意图</th>
          <th>词槽</th>
     </tr>
     <tr>
          <th rowspan="19">房间内场景</th>
          <td>环境监测-空气质量</td>
          <td>环境监测</td>
          <td>环境：空气质量</td>
     </tr>
     <tr>
          <td>环境监测-燃气监测</td>
          <td>环境监测</td>
          <td>环境：煤气</td>
     </tr>
     <tr>
          <td>环境监测-温湿度</td>
          <td>环境监测</td>
          <td>环境：温湿度</td>
     </tr>
     <tr>
          <td>环境监测-漏水检测</td>
          <td>环境监测</td>
          <td>环境：是否漏水</td>
     </tr>
     <tr>
          <td>智能家电-灯光控制</td>
          <td>开关控制</td>
          <td>设备：灯具</td>
     </tr>
     <tr>
          <td>智能家电-窗帘开关</td>
          <td>开关控制</td>
          <td>设备：窗帘</td>
     </tr>
     <tr>
          <td>智能家电-饮水机开关</td>
          <td>开关控制</td>
          <td>设备：饮水机</td>
     </tr>
     <tr>
          <td>智能家电-热水器开关</td>
          <td>开关控制</td>
          <td>设备：热水器</td>
     </tr>
     <tr>
          <td>智能家电-加湿器开关</td>
          <td>开关控制</td>
          <td>设备：加湿器</td>
     </tr>
     <tr>
          <td>智能家电-空调控制</td>
          <td>空调控制-模式切换</td>
          <td>模式名称</td>
     </tr>
     <tr>
          <td>智能家电-空调控制</td>
          <td>空调控制-定时开关</td>
          <td>开启时间<br>关闭时间</td>
     </tr>
     <tr>
          <td>智能家电-空调控制</td>
          <td>空调控制-温度控制</td>
          <td>温度值</td>
     </tr>
     <tr>
          <td>智能家电-电视机控制</td>
          <td>电视机控制-音量控制</td>
          <td>音量值</td>
     </tr>
     <tr>
          <td>智能家电-电视机控制</td>
          <td>电视机控制-频道切换</td>
          <td>频道值</td>
     </tr>
     <tr>
          <td>智能家电-门禁控制</td>
          <td>开关控制</td>
          <td>设备：门</td>
     </tr>
     <tr>
          <td>安全报警-紧急求助</td>
          <td>紧急求助</td>
          <td>联系人</td>
     </tr>
     <tr>
          <td>安全报警-报警器控制</td>
          <td>报警器控制</td>
          <td>报警器种类</td>
     </tr>
     <tr>
          <td>日程提醒</td>
          <td>日程提醒</td>
          <td>时间<br>提醒内容</td>
     </tr>
     <tr>
          <td>意见反馈</td>
          <td>意见反馈</td>
          <td>反馈内容</td>
     </tr>
     <tr>
          <td rowspan="4">问题咨询</td>
          <td>地下车库位置</td>
          <td rowspan="4">问题咨询</td>
          <td rowspan="4">无</td>
     </tr>
     <tr>
          <td>洗衣房位置</td>
     </tr>
     <tr>
          <td>阅览室开放时间</td>
     </tr>
     <tr>
          <td>……</td>
     </tr>
     <tr>
          <td rowspan="3">拓展服务</td>
          <td>城市导览</td>
          <td>城市导览</td>
          <td>城市名</td>
     </tr>
     <tr>
          <td>新闻播报</td>
          <td>新闻播报</td>
          <td>新闻类型<br>播报时间</td>
     </tr>
     <tr>
          <td>休闲聊天</td>
          <td>休闲聊天</td>
          <td>无</td>
     </tr>
	</table>
<br>

<h2 id="2.3">2.3 对话逻辑梳理：任务型对话的常规与异常情况、问答型的知识分类</h2>
<h3>2.3.1 任务型对话的意图梳理</h3>
    任务型对话因具有将请求参数化的这一特点，在配置到对话意图时需整体考虑该场景下的相似任务和相关任务，在这一阶段将对话任务与意图间的映射关系梳理清晰，可以在后续的配置中达到事半功倍的效果。

    以上节中进行了关键信息要素分析的功能为例，在智能家电的开关控制中出现了功能的关键信息要素重合的情况，下面我们针对此类功能进行分析：

　　**家电控制类型功能**

　　在实际的家居场景中用户可能产生远比本文列出的示例更多的对智能家居控制的需求，在需求与意图之间建立一一映射关系不仅会浪费大量的人力，而且存在拓展性差、不同意图间的query相似性强相互干扰影响效果的缺点。因此我们采取合并意图、通过词槽来区分具体方式，这种方式前期工作量小，后期拓展性强。但也不可不管三七二十一将所有物品需求合并为同一意图，需要从实际场景出发进行合理的意图合并与区分。

<br>
	 <table style="margin: 0 auto;width:900px">
     <tr>
          <th style="width:100px">需求分类</th>
          <th style="width:160px">意图</th>
          <th style="width:200px">词槽</th>
          <th>备注</th>
     </tr>
     <tr>
          <td >可泛化需求</td>
          <td>只需要开关控制的电器</td>
          <td>设备：灯具、窗帘、加湿器......</td>
          <td>将只有开关两种指令的电器合并一个意图，后续只需在对应的物品词槽中增删词典即可完成拓展和修改</td>
     </tr>
     <tr>
          <td rowspan="2">不可泛化需求</td>
          <td>特殊物品：空调</td>
          <td>控制指令类型：模式调节、温度调节、定时开关</td>
          <td rowspan="2">有无法与其他意图合并的特殊属性，需要将该类电器每个设备单独设置意图</td>
     </tr>
     <tr>
          <td>特殊物品：电视机</td>
          <td>控制指令类型：模式调节、温度调节、定时开关</td>
     </tr>
	</table>
<br>

<h3>2.3.2 问答型对话的意图梳理</h3>

　　问答型对话没有需要参数化的内容，往往具有固定的标准答案；这类型的对话逻辑梳理其实就是要对问题进行分类，或者叫知识分类。比如智能家居的问题咨询可以如下分类：

<br>
	<table style="margin: 0 auto;width:600px">
     <tr>
          <th>问题类型</th>
          <th>问题</th>
     </tr>
     <tr>
          <td rowspan="4">地下车库位置</td>
          <td>停车场在哪</td>
     </tr>
     <tr>
          <td>地下车库在哪</td>
     </tr>
     <tr>
          <td>在哪停车</td>
     </tr>
     <tr>
          <td>有地下车库吗</td>
     </tr>
     <tr>
		<td colspan="2">......</td>
	</tr>
	</table>
<br>

<h2 id="2.4">2.4   场景数据收集：在真实场景下用户会怎么问？</h2>

  人工智能实现语义理解的过程，和教牙牙学语的小朋友讲话的过程是相似的：最初他只能懂你教他的一模一样的内容（训练数据量少时泛化能力差），等到教的内容多了之后就可以理解这个意思的不同表达方式（基于大量的训练数据产生泛化能力）。

  因此我们在收集场景数据时，需要尽可能贴近真实场景下用户的表达方式，最好是从实际业务场景中沉淀下来的真实数据，全面覆盖用户在该场景下可能出现的表达方式。关于这些数据收集的技巧在《UNIT 使用技巧与持续优化 https://pan.baidu.com/s/1gyQXvExLka5yjdZr3tUziA 》中有详细的介绍，可参考该教程进行数据的收集。
